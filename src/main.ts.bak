import p5 from "p5"
import HalfKite from "./half_kite"
import HalfDart from "./half_dart"
import Point from "./point"

const sketch = (p: p5) => {
  var kite_list: HalfKite[] = [];
  var new_kite_list: HalfKite[] = [];
  var dart_list: HalfDart[] = [];
  var new_dart_list: HalfDart[] = [];

  const drawHalfKite = (hk: HalfKite) => {
    p.fill(p.color("#00ff00"));
    p.triangle(
      hk.pointA.x, hk.pointA.y,
      hk.pointB.x, hk.pointB.y,
      hk.pointC.x, hk.pointC.y
    );
  }

  const drawHalfDart = (hk: HalfDart) => {
    p.fill(p.color("#ff0000"));
    p.triangle(
      hk.pointA.x, hk.pointA.y,
      hk.pointB.x, hk.pointB.y,
      hk.pointC.x, hk.pointC.y
    );
  }

  const drawHalfDart3 = (hk: HalfDart) => {
    p.fill(p.color("#ffff00"));
    p.triangle(
      hk.pointA.x, hk.pointA.y,
      hk.pointB.x, hk.pointB.y,
      hk.pointC.x, hk.pointC.y
    );
  }

  const yieldNewDartFromKite = (kite: HalfKite) :HalfDart[] => {
    let tmp: HalfDart[] = [];
    tmp.push(new HalfDart(kite.pointA, kite.pointD, kite.pointE));
    tmp.push(new HalfDart(kite.pointA, kite.pointD, kite.pointF));
    return tmp;

  }

  const yieldNewKiteFromKite = (kite: HalfKite): HalfKite[] => {
    let tmp: HalfKite[] = [];
    tmp.push(new HalfKite(kite.pointC, kite.pointD, kite.pointB));
    tmp.push(new HalfKite(kite.pointC, kite.pointD, kite.pointE));
    return tmp;
  }

  const yieldNewDartFromDart = (dart: HalfDart): HalfDart[] => {
    let tmp: HalfDart[] = [];
    tmp.push(new HalfDart(dart.pointB, dart.pointC, dart.pointD));
    return tmp;
  }

  const yieldNewKiteFromDart = (dart: HalfDart): HalfKite[] => {
    let tmp: HalfKite[] = [];
    tmp.push(new HalfKite(dart.pointA, dart.pointC, dart.pointD));
    return tmp;
  }

  const drawHalfDart2 = (hk: HalfDart) => {
    p.fill(p.color("#ff00ff"));
    p.triangle(
      hk.pointA.x, hk.pointA.y,
      hk.pointB.x, hk.pointB.y,
      hk.pointC.x, hk.pointC.y
    );
  }

  p.setup = () => {
    p.createCanvas(p.windowWidth, p.windowHeight);
    p.angleMode(p.DEGREES);
    p.background("#131821");

  };

  p.draw = () => {
    p.translate(p.width / 2, p.height / 2);
    let l = Math.max(p.width, p.height) * 0.25;
    let PointA: Point = { x: 0, y: 0 };
    let PointB: Point = { x: l, y: 0 };
    let PointC: Point = { x: l / 2, y: l / 2 * p.tan(36) };
    let dart = new HalfDart(PointA, PointB, PointC);
    
    let tmp = yieldNewDartFromDart(dart);
    drawHalfDart(tmp[0])
    console.log(tmp)
    let tmp2 = yieldNewDartFromDart(tmp[0])
    drawHalfDart2(tmp2[0])
    let tmp3 = yieldNewDartFromDart(tmp2[0])
    drawHalfDart3(tmp3[0])

  p.noLoop();
  };


};

new p5(sketch);
